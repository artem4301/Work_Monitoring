# Автоматический переход к активной смене

## Описание функциональности

Теперь приложение автоматически определяет состояние смены пользователя и перенаправляет к соответствующему экрану:

### Логика навигации

1. **При запуске приложения** (`LoginActivity`):
   - Если пользователь не авторизован → остается на экране входа
   - Если пользователь - менеджер → переход к `ManagerHomeActivity`
   - Если пользователь - работник с активной сменой → переход к `WorkTimeActivity`
   - Если пользователь - работник без активной смены → переход к `HomeActivity`

2. **При открытии HomeActivity**:
   - Проверяется наличие активной смены
   - Если смена активна → автоматический переход к `WorkTimeActivity`
   - Если смены нет → остается на главном экране

3. **После успешной верификации** (`FaceControlActivity`):
   - Обычная верификация → диалог начала смены → переход к `WorkTimeActivity`
   - Периодическая верификация → возобновление смены → переход к `WorkTimeActivity`

### Критерии активной смены

Смена считается активной, если:
- `user.isActive == true`
- `user.shiftStartTime != null`

### Компоненты

#### NavigationHelper
Утилитный класс для централизованной навигации:

```kotlin
// Автоматическая навигация к подходящей активности
NavigationHelper.navigateToAppropriateActivity(context)

// Проверка активной смены
NavigationHelper.checkActiveShift { hasActiveShift ->
    // обработка результата
}

// Получение Intent для правильной активности
val intent = NavigationHelper.getAppropriateIntent(context, user)
```

#### Обновленные активности
- **LoginActivity**: проверка активной смены после авторизации
- **HomeActivity**: проверка активной смены при загрузке данных
- **FaceControlActivity**: переход к WorkTimeActivity после успешной верификации

### Пользовательский сценарий

1. Пользователь начинает смену через фотоконтроль
2. Закрывает приложение
3. Открывает приложение снова
4. **Автоматически попадает на экран активной смены** (`WorkTimeActivity`)
5. Может продолжить работу без дополнительных действий

### Преимущества

- ✅ Бесшовный пользовательский опыт
- ✅ Автоматическое восстановление состояния смены
- ✅ Централизованная логика навигации
- ✅ Поддержка всех типов пользователей (работники/менеджеры)
- ✅ Корректная обработка периодической верификации

### Технические детали

- Проверка состояния происходит через `FirebaseRepository.getCurrentUser()`
- Используются флаги `Intent.FLAG_ACTIVITY_CLEAR_TOP` и `Intent.FLAG_ACTIVITY_NEW_TASK`
- Все переходы завершают предыдущую активность для корректного стека навигации 